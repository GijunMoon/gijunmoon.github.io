---
title: 2024 캔위성 경진대회를 돌아보며 - PCB 제작
categories: [Software, Embedded]
---

### 임무 요구사항 관련

우리 팀의 임무는 지면에서 에너지 하베스팅이었기 때문에, 하베스터의 생산 전력과 현재 배터리의 잔량을 읽을 수 있는 설계가 필요했다. 또한 착륙 후에 지면을 이동할 수 있어야 했으므로 구동 회로 역시 필요했다.

이 모든 기능을 가지면서도, 1kg 이하의 무게를 가져야 했고 손바닥 만한 차체에 들어가야했으므로
최대한 작은 부품들을 한 곳에 모아서 설계해야했다.

위 요구사항을 만족하면서도 내가 짧은 시간 내에 구현 가능한 부품 위주로 찾았다.

MCU는 아두이노 나노로 결정하였다. 추후에 변경하긴 했지만 사용 가능한 모듈 중 크기가 가장 작았기 때문이다.

통신 모듈은 SX1278 LoRa 모듈을 사용했다.

IMU 및 Baro는 GY 시리즈를 사용했다.

![image](/assets/img/240811/image.png)

위와 같은 회로를 설계했다.

그러나 조금 더 소형화가 가능하면 좋겠다는 의견이 있어, 재설계하였다.

![image](/assets/img/240811/image1.png)

최종적으로 위와 같은 모습이 되었다.

MCU는 imu가 통합된 아두이노 나노 BLE를 사용하였다. 

통신 모듈 또한 SMD타입으로 변경하였다.

저항류는 납땜 편의를 위해 핀 타입으로 변경하고, 전원 커넥터와 데이터 커넥터를 변경하였다.

### 패착요인

문제는 여기서부터 시작되었다.

일단 결론은 회로 파손으로 인한 임무 실패이다. (물론 하베스터도 문제가 있었고 구동계도 불안하였으나…)

PCB 기판을 보면 선이 너무 얇다.

저 선은 데이터 뿐만 아니라 전원까지도 흐르는 경로인데, 전압-전류에 비해 너무 얇은 선을 그렸다.

또한 전원부 설계 문제도 있었다.

LoRa 모듈의 경우, 전력을 MCU 이상으로 요구하기 때문에 배터리에서 바로 전원을 넣어주어야하는데

MCU를 통해 공급하도록 설계한 것이다. 그로 인하여 통신 모듈은 작동하지 않고, MCU의 전원부가 파손되어 단락으로 인한 회로 파괴가 발생하였다.

![image](/assets/img/240811/image2.png)

해당 문제가 대회 당일 새벽에 발생하여…

남는 부품을 활용하여 급하게 새 회로를 설계하였다.

이 경우에는 일반 아두이노 나노로 설계 변경하였는데, MCU 사이즈가 동일하더라도 칩셋 아키텍처가 달라서

프로그램을 다시 짜줘야하는 불상사가 발생하였다.

(센서간 통신 방법, 로직 수정 / 데이터 저장 로직 수정 등등…)

결국 대회장 도착전에 완성하지 못하여 깡통 상태로 발사를 진행하였다.

 

### 실패 미션

![image](/assets/img/240811/image3.png)

우리 팀이 실패한 미션 중 하나는 카메라도 있었다.

SD카드에 영상 저장까진 성공하였으나, 원래의 목표인 실시간 영상 전송에는 실패하였다.

영상이 아니라 스틸컷이어도 좋으니, 단 한 장의 사진이라도 전파에 탑재해서 보내는 시도를 굉장히 많이 했는데.

패킷 양의 한계때문에 말도 안되는 시간이 걸렸으며 복호화 마저도 잘 되지 않았다.

그런고로 영상 전송 미션은 일찌감치 포기하였다.

추후에 알아보니 5GHz 이상의 전파나 LTE망을 이용하여 전송하는 방법을 많이 채택하더라, 선택미스였다.

### 결론

![image](/assets/img/240811/image4.png)

이번의 실패 경험을 통해 다음번엔 더 좋은 시스템을 만들어내겠노라

새로운 경험과 다짐을 하는 좋은 기회였던 것 같다.